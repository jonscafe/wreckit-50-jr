from scapy.all import *
import os

# tabel keystroke
keystroke_map = {
    'a': '04', 'b': '05', 'c': '06', 'd': '07', 'e': '08',
    'f': '09', 'g': '0a', 'h': '0b', 'i': '0c', 'j': '0d',
    'k': '0e', 'l': '0f', 'm': '10', 'n': '11', 'o': '12',
    'p': '13', 'q': '14', 'r': '15', 's': '16', 't': '17',
    'u': '18', 'v': '19', 'w': '1a', 'x': '1b', 'y': '1c',
    'z': '1d', '_': '2d', '{': '2f', '}': '30', 'A': '04', 
    'B': '05', 'C': '06', 'D': '07', 'E': '08', 'F': '09', 
    'G': '0a', 'H': '0b', 'I': '0c', 'J': '0d',
    'K': '0e', 'L': '0f', 'M': '10', 'N': '11', 'O': '12',
    'P': '13', 'Q': '14', 'R': '15', 'S': '16', 'T': '17', 
    'U': '18', 'V': '19', 'W': '1a', 'X': '1b', 'Y': '1c', 'Z': '1d',
    '0': '27', '1': '1e', '2': '1f', '3': '20', '4': '21', '5': '22'
}

input_string = "adshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdtessssWRECKIT50{they_said_this_is_usbpcap_but_i_dont_see_the_l2cap_at_least_they_used_usb_hid_aaaa_yeee}adshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdadshsdgsfshdfgsfhsfgsfhsfgsfhsfgsfnsrhsbsfdnsgfdtessssWRECKIT50"
keystrokes = [keystroke_map[char] for char in input_string]
packets = []

for keystroke in keystrokes:
    btl2cap_packet = Ether(src='00:11:22:33:44:55', dst='66:77:88:99:AA:BB')/L2CAP_Hdr(len=1, cid=0x0041)/Raw(load=bytes.fromhex(keystroke))
    packets.append(btl2cap_packet)

output_pcap_file = 'kren.pcap'
wrpcap(output_pcap_file, packets)

print(f'saved {output_pcap_file}')


#Flag WRECKIT50{they_said_this_is_usbpcap_but_i_dont_see_the_l2cap_at_least_they_used_usb_hid_aaaa_yeee}